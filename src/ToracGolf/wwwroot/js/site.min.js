var appToracGolf=angular.module("toracApp",["ngAnimate"]);!function(){"use strict";appToracGolf.factory("FileReader",["$q","$log",function(e,o){var t=function(e,o,t){return function(){t.$apply(function(){o.resolve(e.result)})}},n=function(e,o,t){return function(){t.$apply(function(){o.reject(e.result)})}},i=function(e,o){return function(e){o.$broadcast("fileProgress",{total:e.total,loaded:e.loaded})}},a=function(e,o){var a=new FileReader;return a.onload=t(a,e,o),a.onerror=n(a,e,o),a.onprogress=i(a,o),a};return{ReadAsDataURL:function(o,t){var n=e.defer();if(null==o)return n.resolve(null),n.promise;var i=a(n,t);return i.readAsDataURL(o),n.promise}}}])}(),function(){"use strict";appToracGolf.directive("modal",function(){return{template:'<div class="modal fade"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button><h4 class="modal-title">{{title}}</h4></div><div class="modal-body">{{bodyhtml}}</div><div class="modal-footer"><button type="button" class="btn btn-default btn-primary" data-dismiss="modal">{{closebuttontext}}</button></div></div></div></div>',restrict:"EA",replace:!0,transclude:!0,scope:{onmodalcloseevent:"&",ShowSavedSuccessfulModal:"="},link:function(e,o,t){e.title=t.title,e.bodyhtml=t.bodyhtml,e.closebuttontext=t.closebuttontext,e.$parent.$watch(t.showdialog,function(e){$(o).modal(e?"show":"hide")}),$(o).on("shown.bs.modal",function(){e.$apply(function(){e.$parent[t.visible]=!0})}),$(o).on("hidden.bs.modal",function(){e.$apply(function(){e.$parent[t.visible]=!1,e.onmodalcloseevent()})})}}})}(),function(){"use strict";appToracGolf.service("ValidationService",function(){return{ShowValidationErrors:function(e,o){if(e.validationErrors=[],o.data&&angular.isObject(o.data))for(var t in o.data)e.validationErrors.push(o.data[t][0]);else e.validationErrors.push(o.data)}}})}(),function(){appToracGolf.controller("CourseAddController",["$scope","ValidationService","FileReader","CourseHttp",function(e,o,t,n){e.init=function(o){e.model=o,e.ViewMode="AddCourse"},e.SaveACourse=function(){t.ReadAsDataURL(document.getElementById("CoursePicture").files[0],e).then(function(t){e.model.CourseImage=t,n.AddCourse(e.model,o).then(function(o){e.ShowSavedSuccessfulModal=!0},function(t){o.ShowValidationErrors(e,t)})})},e.SaveACourseDialogOkEvent=function(){window.location.href="/jason"},e.AddTeeLocation=function(){e.TeeLocationTitle="Add A New Tee Location",e.InitTeeLocationView(null,{Description:"",Front9Par:0,Back9Par:0,Yardage:0,Slope:0,Rating:0,Par:function(){return parseInt(this.Front9Par)+parseInt(this.Back9Par)}})},e.EditTeeLocation=function(o){e.TeeLocationTitle="Edit Tee Location",e.InitTeeLocationView(o,e.model.TeeLocations[o])},e.InitTeeLocationView=function(o,t){e.validationErrors=[],e.TempTeeBeforeModifying={Index:o,Model:angular.copy(t)},e.ViewMode="EditTeeLocation",e.TempTeeLocation=angular.copy(t),null!=o&&e.model.TeeLocations.splice(o,1)},e.CancelTeeLocation=function(){e.validationErrors=[],null!=e.TempTeeBeforeModifying.Index&&e.model.TeeLocations.splice(e.TempTeeBeforeModifying.Index,0,e.TempTeeBeforeModifying.Model),e.ViewMode="AddCourse"},e.SaveTeeLocation=function(){return e.model.TeeLocations.Any(function(o){return o.Description===e.TempTeeLocation.Description})?void o.ShowValidationErrors(e,{data:"There is already a tee box with the same name"}):void n.AddTeeLocation(e.TempTeeLocation,o).then(function(o){e.model.TeeLocations.push(e.TempTeeLocation),e.ViewMode="AddCourse",e.validationErrors=[]},function(t){o.ShowValidationErrors(e,t)})},e.DeleteTeeLocation=function(o){e.model.TeeLocations.splice(o,1)},e.DefaultTeeButton=function(o){(o.which&&13==o.which||o.keyCode&&13==o.keyCode)&&e.SaveTeeLocation()}}])}(),function(){"use strict";appToracGolf.service("CourseHttp",["$http",function(e){return e.defaults.headers.common.RequestVerificationToken=$("[name=__RequestVerificationToken]").val(),{AddCourse:function(o,t){return e.post("AddACourse",o,t)},AddTeeLocation:function(o,t){return e.post("ValidateTeeLocation",o,t)}}}])}();